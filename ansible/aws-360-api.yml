---

- name: Pre-step
  hosts: all
  become: true
  gather_facts: no
  pre_tasks:
    - name: Install Python 2
      raw: bash -c "test -e /usr/bin/python || (apt -qqy update && apt install -qqy python-minimal)"
      register: __python2_requirement
      changed_when: __python2_requirement.stdout != ""
      tags:
        - always

- name: AWS 360 API
  hosts: all
  become: true  
  roles:
    - role: Lowess.common
      tags: common

    - role: Lowess.netdata
      tags: netdata

    - role: Lowess.nginx
      tags: nginx

    - role: Lowess.uwsgi
      tags: uwsgi

    - role: Lowess.aws_360_api
      tags: api
